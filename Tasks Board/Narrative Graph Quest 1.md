---
developers:
start: 2025-12-11
deadline: 2025-12-17
status: In progress
tags:
  - task
  - egor
  - polina
---
---
# Task Description

Граф восприятия — это сеть сюжетных фрагментов, в которой порядок открытия вер-
шин (событий) изменяет смысл уже увиденного. Игрок видит фрагменты одной общей
истории в рамках одной локации, но в случайном порядке. Каждый фрагмент кажется
ему самостоятельным эпизодом — пока он не столкнется с другим, который пересоби-
рает контекст. Каждая новая вершина может расширить, поставить под сомнение или
перевернуть интерпретацию предыдущих событий.

Написать тестовый граф одного квеста, для проверки работоспособности механики нарративного графа. Добавить третьего персонажа к королю и брахману. 

Так как игрок может начать историю со встречи с любым из трех персонажей, нужно прописать Initial State для начала

%% Я взял этот отрывок из сборника мудростей Махабхараты.%%
Брахман, великий знаток Веды, бывший и прекрасным лучником, встретил своего старого друга, который стал королем. Брахман вскричал, увидев короля
— Признай меня, я твой друг! — Король взглянул на него с презрением, а затем пояснил
— Да, мы были друзьями прежде, но наша дружба основывалась на власти, которой мы обладали... Я дружил с тобой, добрый брахман, потому что это служило моей цели. Бедный не может быть другом богатому, глупый — умному, трус — смелому. Старый друг — кому он нужен? Два человека, равных по достатку и по рождению, договариваются о дружбе или о заключении брачного союза, но не богач и бедняк... Старый друг — кому он нужен?

**Махабхарата**

%%
Брахман — член высшей варны в индуистской традиции, связанной со священными знаниями, ритуальной практикой и преподаванием религиозных текстов. Его роль заключается в сохранении и передаче духовного учения.
%%

---


Квест использует **двух NPC**:

1. **Брахман** — обиженный гордый мудрец, бывший лучник.
2. **Король** — его старый друг, ныне высокомерный правитель.

Игрок может начать с любого из них.  
Важно: реплики и поведение NPC меняются, если игрок уже пообщался с другим.

# Граф квеста

## Initial State Брахмана

**Условие** 
игрок ещё не встречал Короля.

**Сцена:** 
Брахман сидит на камне у дороги, перебирая пальцами старый лук. Лицо усталое, но глаза цепкие. Он поднимает взгляд.  
Монах… Ты не похож на тех, кто приходит искать мудрости. Старые узы иногда тянут сильнее, чем судьба. Мой друг изменился, для него я стал тем, кого он не считает другом боле."

После A1 любые последующие сцены с Королём должны быть без его initial state (B1) и переходят к B2.

---

## Вершина A2 — Брахман объясняет причину разрыва

**Условие:** посещена A1, Король ещё не встречен.

**Сцена:**  
— Когда власть входит в сердце, — говорит он, — память выходит из него. Он видел во мне равного, пока мы оба стояли на поле, где только лук и дыхание определяли человека. Сейчас же… он считает, что дружба требует одинаковых тронов.

**Последствия:**  
Открывает путь к A3 или к встрече с Королём (B2).

---

## Вершина A3 — Брахман сомневается

**Условие:** посещена A1, Король ещё не встречен.

**Сцена:**  
— Быть может, я ошибся. Быть может, годы изменили не его, а меня. Но одно я знаю: если он отвергнет меня вновь, я пойму, что старый друг — действительно никому не нужен.

**Последствия:**  
Переход к встрече с Королём (B2).

---

## Вершина A4 — Брахман после встречи игрока с Королём

**Условие:** игрок уже посетил Короля (любая сцена из B2 или B3).

**Сцена:**  
Брахман встречает игрока настороженно.  
— Ты видел его? — спрашивает он без приветствия. — Сказал ли он хоть одно слово о прошлом? Он теперь говорит так, будто дружба — это договор богатых домов.

**Варианты реакции игрока:**

1. «Он отрицает вашу дружбу.» → открывает A5.
    
2. «Он считает, что времена изменились.» → открывает A6.
    
3. «Он больше защищается, чем нападает.» → открывает A7.
    

---

## Вершина A5 — Гнев Брахмана

**Условие:** выбрана реплика 1 в A4.

**Сцена:**  
— Тогда его сердце закрыто. Для него я стал бедняком, а значит — чужим. Так говорит тот, кто боится собственного прошлого.

**Последствия:**  
Возникает новое условие для ветки Короля — Король становится менее резким в ответах (открывает B3-Aware).

---

## Вершина A6 — Сдержанная печаль

**Условие:** выбрана реплика 2 в A4.

**Сцена:**  
— Если времена изменились… почему тогда меняется только он? Я ведь не просил трона. Я просил лишь, чтобы он узнал меня.

**Последствия:**  
Король получает более мягкую, но всё ещё высокомерную линию в B3-Aware.

---

## Вершина A7 — Сомнение

**Условие:** выбрана реплика 3 в A4.

**Сцена:**  
— Защищается? От кого? От воспоминаний, которые он сам же и разрушил?

**Последствия:**  
Открывает альтернативную эмоциональную ветку Короля в B3-Confront.

---

---

# Вершины Короля

## Вершина B1 — Initial State Короля

**Условие:** игрок ещё не встречал Брахмана.

**Сцена:**  
Король стоит у балюстрады, наблюдая за тренировкой лучников. Он даже не смотрит на игрока.  
— Если пришёл просить одолжения, говори кратко.  
Через мгновение он уточняет:  
— Когда-то один человек стоял рядом со мной. Но годы показывают, кто достоин был идти дальше.

**Выборы:**

1. «Кто он?» → открывает B2.
    
2. «Ты говоришь о бывшем друге?» → открывает B2.
    
3. «Я встретил странствующего мудреца…» → если игрок ещё не встречал Брахмана, ветка закрыта; если встречал — открывает B3-Aware.
    

---

## Вершина B2 — Король отвергает прошлое

**Условие:** игрок встретил Короля до Брахмана или пришёл к нему из A1–A3.

**Сцена:**  
— Да, мы были друзьями прежде, — произносит он. — Но дружба была удобством. Богатый не делит путь с бедняком, сильный — с слабым. Старый друг… кому он нужен?

**Последствия:**  
Если игрок ещё не встречал Брахмана — активируется A4 при встрече.  
Если встречал — активируется A5/A6/A7 в зависимости от его выбора.

---

## Вершина B3-Aware — Король знает, что игрок был у Брахмана

**Условие:** игрок уже встретил Брахмана и провёл с ним беседу (A4).

**Сцена:**  
Король говорит без привычного высокомерия:  
— Он всё ещё цепляется за то, что было. Но прошлое — тяжёлый камень. Не всем стоит его поднимать.

**Реакции игрока:**

1. «Ты несправедлив к нему.» → открывает B4.
    
2. «Он говорит, что ты изменился.» → открывает B5.
    
3. «Он хочет лишь быть признанным.» → открывает B6.
    

---

## Вершина B3-Confront — Король в состоянии защиты

**Условие:** выбран A7.

**Сцена:**  
— Он обвиняет меня? После всего? Он всегда был склонен драматизировать.

**Последствия:**  
Игрок может вывести его на искренность в B6 или подтолкнуть к резкой ссоре (B7).

---

## Вершина B4 — Смягчение

**Условие:** выбрана реплика 1 в B3-Aware.

**Сцена:**  
— Может, ты права. Но порой легче отвергнуть прошлое, чем признать свою вину.

**Последствия:**  
Открывает финальные узлы примирения.

---

## Вершина B5 — Король оправдывается

**Сцена:**  
— Изменился… да. Но не так, как он думает. Я стал тем, кем обязан быть.

**Последствия:**  
Открывает финальную развилку: примирение или окончательный разрыв.

---

## Вершина B6 — Король раскрывает мотив

**Сцена:**  
— Признание… Что ж. Я признаю, что обязан ему многим. Но долг и дружба — разное.

**Последствия:**  
В зависимости от дальнейших слов игрока возможны две финальные ветви.

---

## Вершина B7 — Разрыв

**Условие:** конфликтная линия.

**Сцена:**  
— Тогда пусть он живёт в своих воспоминаниях. В моём мире для него места нет.

**Последствия:**  
Финальная ветка: король отказывается от примирения.

---

# Финальные узлы

## F1 — Примирение

Брахман и Король, каждый через слова игрока, понимают взаимные заблуждения.  
Оба персонажа в дальнейшем становятся доступными как союзники.

## F2 — Холодный нейтралитет

Каждый признаёт прошлое, но не стремится восстановить связь.

## F3 — Окончательный разрыв

Король и Брахман больше не будут общаться. Сюжетные линии расходятся.

---

Если нужно, могу оформить это в табличный формат, превратить в JSON-структуру для движка или расширить до трёх персонажей и встроенного меж-NPC диалога.



